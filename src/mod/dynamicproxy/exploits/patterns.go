package exploits

/*
	patterns.go

	This file contains all the regex patterns used for exploit detection.
	These patterns are declared once at the package level to avoid
	redeclaration on every request.
*/

// SQL injection patterns
var sqlInjectionPatterns = []string{
	`union.*select.*\(`,
	`union.*all.*select.*`,
	`concat.*\(`,
}

// File injection patterns
var fileInjectionPatterns = []string{
	`[a-zA-Z0-9_]=http://`,
	`[a-zA-Z0-9_]=(\.\.//?)+`,
	`[a-zA-Z0-9_]=/([a-z0-9_.]//?)+`,
}

// Common exploit patterns
var commonExploitPatterns = []string{
	`(<|%3C).*script.*(>|%3E)`,
	`GLOBALS(=|\[|\%[0-9A-Z]{0,2})`,
	`_REQUEST(=|\[|\%[0-9A-Z]{0,2})`,
	`proc/self/environ`,
	`mosConfig_[a-zA-Z_]{1,21}(=|\%3D)`,
	`base64_(en|de)code\(.*\)`,
}

// Spam patterns
var spamPatterns = []string{
	`\b(ultram|unicauca|valium|viagra|vicodin|xanax|ypxaieo)\b`,
	`\b(erections|hoodia|huronriveracres|impotence|levitra|libido)\b`,
	`\b(ambien|blue\spill|cialis|cocaine|ejaculation|erectile)\b`,
	`\b(lipitor|phentermin|pro[sz]ac|sandyauer|tramadol|troyhamby)\b`,
}

// Malicious user agent patterns
var maliciousUserAgentPatterns = []string{
	`Indy Library`,
	`libwww-perl`,
	`GetRight`,
	`GetWeb!`,
	`Go!Zilla`,
	`Download Demon`,
	`Go-Ahead-Got-It`,
	`TurnitinBot`,
	`GrabNet`,
}

// AI bot patterns
var aiBotPatterns = []string{
	// OpenAI
	`(?i)gptbot`,
	`(?i)chatgpt-user`,
	`(?i)oai-searchbot`,

	// Anthropic (Claude)
	`(?i)claudebot`,
	`(?i)claude-web`,
	`(?i)anthropic-ai`,
	`(?i)anthropic-research`,

	// Google AI
	`(?i)google-extended`,
	`(?i)gemini-deep-research`,

	// Meta (Facebook)
	`(?i)facebookbot`,
	`(?i)meta-externalagent`,
	`(?i)meta-externalfetcher`,
	`(?i)facebookexternalhit`,

	// ByteDance (AGGRESSIVE - ignores robots.txt)
	`(?i)bytespider`,

	// Baidu
	`(?i)baiduspider`,
	`(?i)erniebot`,

	// Apple
	`(?i)applebot-extended`,

	// Amazon
	`(?i)amazonbot`,

	// Other AI companies
	`(?i)cohere-ai`,
	`(?i)perplexitybot`,
	`(?i)youbot`,
	`(?i)diffbot`,
	`(?i)omgilibot`,
	`(?i)mistralai-user`,

	// Chinese AI crawlers (AGGRESSIVE)
	`(?i)360spider`,
	`(?i)chatglm-spider`,
	`(?i)sogou`,
	`(?i)deepseekbot`,
	`(?i)pangubot`,
}

// Common bot user-agent patterns
var commonBotPatterns = []string{
	`(?i)googlebot`,
	`(?i)storebot-google`,
	`(?i)yandexbot`,
	`(?i)duckduckbot`,
	`(?i)slurp`,       // Yahoo
	`(?i)teoma`,       // Ask.com
	`(?i)ia_archiver`, // Alexa
	`(?i)twitterbot`,
	`(?i)linkedinbot`,
	`(?i)whatsapp`,
	`(?i)telegrambot`,
	`(?i)slackbot`,
	`(?i)discordbot`,
	`(?i)applebot`,
	`(?i)semrushbot`,
	`(?i)ahrefsbot`,
	`(?i)dotbot`,
	`(?i)mj12bot`,
	`(?i)rogerbot`, // Moz
	`(?i)exabot`,
	`(?i)facebot`,
	`(?i)seznambot`,
	`(?i)archive\.org_bot`,
	`(?i)petalbot`, // Huawei
	`(?i)yisouspider`,
	`(?i)ccbot`,
}
